[{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"spacehakr","title":"spacehakr","text":"R package spatial analysis, raster processing, geospatial data access. Extracted ngr_spk_* function family ngr package.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"repository-context","dir":"","previous_headings":"","what":"Repository Context","title":"spacehakr","text":"Repository: NewGraphEnvironment/spacehakr Primary Language: R License: MIT URL: http://www.newgraphenvironment.com/spacehakr/","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"migration-from-ngr","dir":"","previous_headings":"","what":"Migration from ngr","title":"spacehakr","text":"Functions renamed ngr_spk_* spk_*: Tests transfer rename pattern.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"build--test-commands","dir":"","previous_headings":"","what":"Build & Test Commands","title":"spacehakr","text":"Prefer devtools::test() development - ’s faster run devtools::check() preparing release CI Always skip vignettes checks (vignettes = FALSE)","code":"devtools::document() devtools::test()                    # Use this for development - faster devtools::check(vignettes = FALSE)  # Only when needed; always skip vignettes lintr::lint_package()               # Run before committing devtools::install()"},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"function-naming","dir":"","previous_headings":"","what":"Function Naming","title":"spacehakr","text":"exported functions use prefix spk_: - spk_rast_* - Raster operations - spk_gdalwarp(), spk_odm() - External tool command builders - spk_geoserv_*, spk_stac_* - Remote data access - spk_join(), spk_poly_to_points(), spk_layer_info() - Vector/spatial operations","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"architecture","dir":"","previous_headings":"","what":"Architecture","title":"spacehakr","text":"","code":"R/                  # Function source files, one function per file tests/testthat/     # testthat tests, one test file per function man/                # Generated by roxygen2 (never edit manually) vignettes/          # Long-form documentation data-raw/           # Scripts for generating package data (hex sticker, etc.) dev/                # Development scripts (not in package)"},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"key-dependencies","dir":"","previous_headings":"","what":"Key Dependencies","title":"spacehakr","text":"sf - Vector spatial data (simple features) terra - Raster operations chk - Argument validation (chk_string(), chk_flag(), etc.) cli - User messaging (cli_abort(), cli_alert_success()) dplyr/purrr/stringr - Data wrangling fs - File system operations glue - String interpolation httr/curl - HTTP requests xml2 - XML parsing (QGIS project files) Vignette-packages go Suggests (e.g., rstac, leaflet, mapview).","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"documentation-style","dir":"","previous_headings":"","what":"Documentation Style","title":"spacehakr","text":"Roxygen2 markdown enabled (Roxygen: list(markdown = TRUE)) @family spacehakr tag exported functions @importFrom external functions (explicit, never @import) @examples \\dontrun{} slow/network examples @seealso related functions","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"lintr","dir":"","previous_headings":"Code Quality Standards","what":"lintr","title":"spacehakr","text":"Use lintr static analysis. Follow default tidyverse style : - Line length max 120 characters - snake_case names - assignment = (use <-)","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"dry-dont-repeat-yourself","dir":"","previous_headings":"Code Quality Standards","what":"DRY (Don’t Repeat Yourself)","title":"spacehakr","text":"Extract shared logic internal helpers (exported, @export) Name internal helpers leading dot descriptive name without spk_ prefix pattern appears 3+ times, factor ","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"yagni-you-arent-gonna-need-it","dir":"","previous_headings":"Code Quality Standards","what":"YAGNI (You Aren’t Gonna Need It)","title":"spacehakr","text":"Don’t add parameters “just case” Don’t write generalized versions specific functions feature isn’t needed now, don’t build Default parameter values cover 90% use cases","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"kiss-keep-it-simple","dir":"","previous_headings":"Code Quality Standards","what":"KISS (Keep It Simple)","title":"spacehakr","text":"One function per file, named match (spk_join.R contains spk_join()) Flat control flow preferred deeply nested logic Early returns guard clauses Pipe chains (|>) data transformation, side effects","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"defensive-programming","dir":"","previous_headings":"Code Quality Standards","what":"Defensive Programming","title":"spacehakr","text":"Validate user-facing inputs chk function entry Use cli::cli_abort() errors informative messages Never silently swallow errors warnings Document expected types @param","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"commit-style-fledge","dir":"","previous_headings":"","what":"Commit Style (fledge)","title":"spacehakr","text":"repo uses fledge changelog management. NEWS-worthy commits start - (bullet point): Function references use square brackets pkgdown auto-links: [spk_join()] Issue references use full markdown links: [#1](https://github.com/NewGraphEnvironment/spacehakr/issues/1) Non-NEWS commits (docs, chores) don’t start -:","code":"- initial commit of [spk_join()] to close [#1](https://github.com/NewGraphEnvironment/spacehakr/issues/1) rebuild documentation and update build config"},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"description-management","dir":"","previous_headings":"","what":"DESCRIPTION Management","title":"spacehakr","text":"Keep Imports alphabetized Don’t duplicate packages Imports Suggests Add vignette-packages Suggests","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"hex-sticker","dir":"","previous_headings":"","what":"Hex Sticker","title":"spacehakr","text":"Generate data-raw/make_hexsticker.R using hexSticker package. Black background, white NG icon, white “spacehakr” text, Helvetica font.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"github-cli-gh-idiosyncrasies","dir":"","previous_headings":"","what":"GitHub CLI (gh) Idiosyncrasies","title":"spacehakr","text":"Use backticks function names issue titles: gh issue create --title \"Add \\`spk_join()\\`\" gh milestone command - use gh api milestones --milestone flag needs title, number","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"llm-behavioral-guidelines","dir":"","previous_headings":"","what":"LLM Behavioral Guidelines","title":"spacehakr","text":"Reduce common LLM coding mistakes. Bias toward caution speed. trivial tasks, use judgment.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"id_1-think-before-coding","dir":"","previous_headings":"","what":"1. Think Before Coding","title":"spacehakr","text":"Don’t assume. Don’t hide confusion. Surface tradeoffs. implementing: - State assumptions explicitly. uncertain, ask. - multiple interpretations exist, present - don’t pick silently. - simpler approach exists, say . Push back warranted. - something unclear, stop. Name ’s confusing. Ask.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"id_2-simplicity-first","dir":"","previous_headings":"","what":"2. Simplicity First","title":"spacehakr","text":"Minimum code solves problem. Nothing speculative. features beyond asked. abstractions single-use code. “flexibility” “configurability” wasn’t requested. error handling impossible scenarios. write 200 lines 50, rewrite . Ask : “senior engineer say overcomplicated?” yes, simplify.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"id_3-surgical-changes","dir":"","previous_headings":"","what":"3. Surgical Changes","title":"spacehakr","text":"Touch must. Clean mess. editing existing code: - Don’t “improve” adjacent code, comments, formatting. - Don’t refactor things aren’t broken. - Match existing style, even ’d differently. - notice unrelated dead code, mention - don’t delete . changes create orphans: - Remove imports/variables/functions changes made unused. - Don’t remove pre-existing dead code unless asked. test: Every changed line trace directly user’s request.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"id_4-goal-driven-execution","dir":"","previous_headings":"","what":"4. Goal-Driven Execution","title":"spacehakr","text":"Define success criteria. Loop verified. Transform tasks verifiable goals: - “Add validation” -> “Write tests invalid inputs, make pass” - “Fix bug” -> “Write test reproduces , make pass” - “Refactor X” -> “Ensure tests pass ” multi-step tasks, state brief plan: guidelines working : fewer unnecessary changes diffs, fewer rewrites due overcomplication, clarifying questions come implementation rather mistakes.","code":"1. [Step] -> verify: [check] 2. [Step] -> verify: [check] 3. [Step] -> verify: [check]"},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"newgraph-environment-conventions","dir":"","previous_headings":"","what":"NewGraph Environment Conventions","title":"spacehakr","text":"Core patterns professional, efficient workflows across NewGraph repositories.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"professional-issue-writing","dir":"","previous_headings":"Issue Creation Guidelines","what":"Professional Issue Writing","title":"spacehakr","text":"Write issues clear technical focus: Use normal technical language titles descriptions Focus problem solution approach Avoid internal project codes tracking references main description Add tracking links end needed (e.g., Relates Owner/repo#N) : Issues read consultants, clients, collaborators. Keep professional focused technical content.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"github-issue-creation---always-use-files","dir":"","previous_headings":"Issue Creation Guidelines","what":"GitHub Issue Creation - Always Use Files","title":"spacehakr","text":"gh issue create command heredoc syntax fails repeatedly EOF errors. ALWAYS use intermediate file approach:","code":"# Write issue body to scratchpad file first cat > /path/to/scratchpad/issue_body.md << 'EOF' ## Problem ...  ## Proposed Solution ... EOF  # Then create issue from file gh issue create --title \"Brief technical title\" --body-file /path/to/scratchpad/issue_body.md"},{"path":"http://www.newgraphenvironment.com/spacehakr/CLAUDE.html","id":"commit-quality","dir":"","previous_headings":"","what":"Commit Quality","title":"spacehakr","text":"Write clear, informative commit messages: commit: - Logical, atomic units work - Working state (tests pass) - Clear description changes avoid: - “WIP” “temp” commits main branch - Combining unrelated changes - Vague messages like “fixes” “updates”","code":"Brief description (50 chars or less)  Detailed explanation of changes and impact. - What changed - Why it changed - Relevant context  Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>"},{"path":"http://www.newgraphenvironment.com/spacehakr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Allan Irvine. Author, maintainer.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Irvine (2026). spacehakr: Spatial Analysis, Raster Processing, Geospatial Data Access. R package version 0.0.0.9000, https://github.com/NewGraphEnvironment/spacehakr.","code":"@Manual{,   title = {spacehakr: Spatial Analysis, Raster Processing, and Geospatial Data Access},   author = {Allan Irvine},   year = {2026},   note = {R package version 0.0.0.9000},   url = {https://github.com/NewGraphEnvironment/spacehakr}, }"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"spacehakr-","dir":"","previous_headings":"","what":"Spatial Analysis, Raster Processing, and Geospatial Data Access","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Spatial analysis geospatial data tools R — raster processing, WFS access, GDAL command building, spatial joins, STAC catalog queries.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"","code":"# install.packages(\"pak\") pak::pkg_install(\"NewGraphEnvironment/spacehakr\")"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"","code":"library(spacehakr) library(sf) #> Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE library(terra) #> terra 1.8.93"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"inspect-layers-in-a-geopackage","dir":"","previous_headings":"Examples","what":"Inspect Layers in a GeoPackage","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Query layer names geometry types vector data source:","code":"# Get path to bundled test data gpkg_path <- system.file(\"extdata\", \"poly.gpkg\", package = \"spacehakr\")  spk_layer_info(gpkg_path) #>   name geomtype features fields #> 1 poly  POLYGON        5      3 #>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       crs #> 1 WGS 84, GEOGCRS[\"WGS 84\",\\n    ENSEMBLE[\"World Geodetic System 1984 ensemble\",\\n        MEMBER[\"World Geodetic System 1984 (Transit)\"],\\n        MEMBER[\"World Geodetic System 1984 (G730)\"],\\n        MEMBER[\"World Geodetic System 1984 (G873)\"],\\n        MEMBER[\"World Geodetic System 1984 (G1150)\"],\\n        MEMBER[\"World Geodetic System 1984 (G1674)\"],\\n        MEMBER[\"World Geodetic System 1984 (G1762)\"],\\n        MEMBER[\"World Geodetic System 1984 (G2139)\"],\\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\\n            LENGTHUNIT[\"metre\",1]],\\n        ENSEMBLEACCURACY[2.0]],\\n    PRIMEM[\"Greenwich\",0,\\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\\n    CS[ellipsoidal,2],\\n        AXIS[\"geodetic latitude (Lat)\",north,\\n            ORDER[1],\\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\\n        AXIS[\"geodetic longitude (Lon)\",east,\\n            ORDER[2],\\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\\n    USAGE[\\n        SCOPE[\"Horizontal component of 3D system.\"],\\n        AREA[\"World.\"],\\n        BBOX[-90,-180,90,180]],\\n    ID[\"EPSG\",4326]]"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"compute-combined-extent-from-multiple-rasters","dir":"","previous_headings":"Examples","what":"Compute Combined Extent from Multiple Rasters","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Calculate union bounding box across multiple raster files:","code":"# Get paths to bundled test rasters rast_files <- c(   system.file(\"extdata\", \"test1.tif\", package = \"spacehakr\"),   system.file(\"extdata\", \"test2.tif\", package = \"spacehakr\") )  # Get combined extent bbox <- spk_rast_ext(rast_files) bbox #>      xmin      ymin      xmax      ymax  #>  668376.2 6042688.0  672724.8 6046013.4"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"spatial-joins-with-filtering","dir":"","previous_headings":"Examples","what":"Spatial Joins with Filtering","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Join points polygons optional column selection filtering:","code":"# Load bundled test data points <- st_read(   system.file(\"extdata\", \"points.gpkg\", package = \"spacehakr\"),    quiet = TRUE ) polygons <- st_read(   system.file(\"extdata\", \"poly.gpkg\", package = \"spacehakr\"),    quiet = TRUE )  # Join points to polygons, returning specific columns result <- spk_join(   target_tbl = points,   mask_tbl = polygons,   target_col_return = \"id\",   mask_col_return = \"attribute_string\" )  result #> Simple feature collection with 7 features and 2 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 0 ymin: 0 xmax: 10 ymax: 10 #> Geodetic CRS:  WGS 84 #>     id attribute_string          geom #> 1    1                a   POINT (0 0) #> 1.1  1                b   POINT (0 0) #> 2    2                b   POINT (1 1) #> 2.1  2                c   POINT (1 1) #> 3    3                d   POINT (2 2) #> 4    4                e   POINT (3 3) #> 5    5             <NA> POINT (10 10)"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"build-gdal-warp-commands","dir":"","previous_headings":"Examples","what":"Build GDAL Warp Commands","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Generate GDAL command strings raster reprojection:","code":"# Build a gdalwarp command (interactive = TRUE returns full command string) input_file <- system.file(\"extdata\", \"test1.tif\", package = \"spacehakr\")  cmd <- spk_gdalwarp(   path_in = input_file,   path_out = file.path(tempdir(), \"output.tif\"),   t_srs = \"EPSG:3005\",   target_resolution = c(10, 10),   resampling = \"bilinear\",   interactive = TRUE )  cat(cmd) #> gdalwarp -overwrite -multi -wo NUM_THREADS=ALL_CPUS -t_srs EPSG:3005 -r bilinear -tr 10 10 /tmp/RtmpWmInno/temp_libpathd1f65705ea16/spacehakr/extdata/test1.tif /tmp/Rtmpc0pAHm/output.tif"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"download-from-geoserver-wfs","dir":"","previous_headings":"Examples","what":"Download from GeoServer WFS","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Fetch vector data BC’s GeoServer (requires network access):","code":"# Download contour lines within a bounding box contours <- spk_geoserv_dlv(   url_geoserver = \"https://openmaps.gov.bc.ca/geo/pub/ows\",   dir_out = tempdir(),   layer_name_raw = \"pub:WHSE_BASEMAPPING.TRIM_CONTOUR_LINES\",   bbox = c(-123.5, 48.0, -123.0, 48.5),   crs = 4326 )"},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"query-stac-catalogs","dir":"","previous_headings":"Examples","what":"Query STAC Catalogs","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"Calculate spectral indices STAC items (requires rstac network access):","code":"library(rstac)  # Query Landsat data items <- stac(\"https://planetarycomputer.microsoft.com/api/stac/v1\") |>   stac_search(     collections = \"landsat-c2-l2\",     bbox = c(-123.5, 48.0, -123.0, 48.5),     datetime = \"2023-06-01/2023-08-31\"   ) |>   post_request() |>   items_sign(sign_fn = sign_planetary_computer())  # Calculate NDVI from the first item ndvi <- spk_stac_calc(   feature = items$features[[1]],   asset_a = \"red\",   asset_b = \"nir08\",   calc = \"ndvi\" )"},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Spatial Analysis, Raster Processing, and Geospatial Data Access","text":"MIT","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate GDALWarp Command Arguments — spk_gdalwarp","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"Constructs command-line arguments GDAL's gdalwarp utility, allowing flexible reprojection resampling raster data. function can return either vector arguments programmatic use complete command string manual execution interactive = TRUE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"","code":"spk_gdalwarp(   path_in,   path_out,   s_srs = NULL,   t_srs = \"EPSG:3005\",   resampling = \"bilinear\",   target_resolution = c(0.15, 0.15),   overwrite = TRUE,   interactive = FALSE,   params_default = c(\"-multi\", \"-wo\", \"NUM_THREADS=ALL_CPUS\"),   params_add = NULL )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"path_in character vector file paths input rasters. Must valid file paths. path_out character single file path output raster. directory must exist. s_srs character NULL Optional. source spatial reference system GDAL-supported format (e.g., EPSG codes, PROJ strings). Defaults NULL, meaning inferred input raster. t_srs character target spatial reference system GDAL-supported format. Defaults \"EPSG:3005\". resampling character resampling method. One \"nearest\", \"bilinear\", \"cubic\", \"cubicspline\", \"lanczos\", \"average\", \"mode\". Defaults \"bilinear\". target_resolution numeric numeric vector length 2 specifying output pixel resolution meters x y directions. Defaults c(0.15, 0.15) (15cm x 15cm pixels). overwrite logical Whether overwrite output file exists. Defaults TRUE. interactive logical Whether return full gdalwarp command string manual use. Defaults FALSE. params_default character NULL Optional. character vector default parameters include gdalwarp command. Defaults c(\"-multi\", \"-wo\", \"NUM_THREADS=ALL_CPUS\"). params_add character NULL Optional. character vector additional parameters include gdalwarp command.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"character vector arguments programmatic use complete command string interactive = TRUE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"function constructs command-line arguments gdalwarp, enabling flexible raster reprojection, resampling, transformation. Note gdalwarp requires GDAL installed system. macOS, can install GDAL using Homebrew running brew install gdal. details gdalwarp, visit: https://gdal.org/en/stable/programs/gdalwarp.html.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_gdalwarp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate GDALWarp Command Arguments — spk_gdalwarp","text":"","code":"if (FALSE) { # \\dontrun{ # Generate arguments for programmatic use args <- spk_gdalwarp(   path_in = c(\"input1.tif\", \"input2.tif\"),   path_out = \"output.tif\",   s_srs = \"EPSG:4326\",   t_srs = \"EPSG:3857\",   target_resolution = c(0.1, 0.1) )  # Generate a full command for manual use cmd <- spk_gdalwarp(   path_in = c(\"input1.tif\", \"input2.tif\"),   path_out = \"output.tif\",   s_srs = \"EPSG:4326\",   t_srs = \"EPSG:3857\",   target_resolution = c(0.1, 0.1),   interactive = TRUE ) cat(cmd, \"\\n\") } # }"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":null,"dir":"Reference","previous_headings":"","what":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"function downloads single vector layer WFS (Web Feature Service) endpoint saves locally GeoJSON another supported format.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"","code":"spk_geoserv_dlv(   url_geoserver = \"https://maps.skeenasalmon.info/geoserver/ows\",   dir_out = NULL,   layer_name_raw = NULL,   layer_name_out = stringr::str_extract(layer_name_raw, \"(?<=:).*\"),   crs = 3005,   bbox = NULL,   format_out = \"json\",   discard_no_features = TRUE )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"url_geoserver character single URL string GeoServer WFS endpoint. dir_out character directory path output file saved. Must exist creatable. layer_name_raw character WFS layer name, usually including namespace (e.g., geonode:LayerName). layer_name_out character Optional. Output file name without extension. Defaults name extracted layer_name_raw. crs integer EPSG code coordinate reference system request server. Default 3005. bbox sf::st_bbox() Optional. bounding box filter features spatially. Must CRS coercible. format_out character WFS output format. Common values: \"json\", \"GML2\", \"shape-zip\". Default \"json\" function need modified future accommodate formats. discard_no_features logical Optional. TRUE, automatically deletes downloaded files zero features. Default TRUE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"Invisibly returns output file path success. Prints status messages console.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"default, layer_name_out inferred layer_name_raw removing namespace prefix (e.g., geonode:), common GeoServer layers. bounding box passed sf::st_bbox() object different CRS target CRS, transformed using sf::st_transform(). Regardless discard_no_features, function scan first lines downloaded GeoJSON file warn features found. discard_no_features = TRUE, empty file deleted.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_geoserv_dlv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download a Vector Layer from a GeoServer WFS — spk_geoserv_dlv","text":"","code":"if (FALSE) { # \\dontrun{ dir_out <- \"data/gis/skt/esi_sows\" layer_name_raw <- \"geonode:UBulkley_wshed\" spk_geoserv_dl(   dir_out = dir_out,   layer_name_raw = layer_name_raw ) } # }"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_join.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial Join with Optional Mask Filtering and Column Selection — spk_join","title":"Spatial Join with Optional Mask Filtering and Column Selection — spk_join","text":"Joins target sf::sf object mask sf::sf object using specified spatial predicate. Optional filtering selection columns mask can applied.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_join.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial Join with Optional Mask Filtering and Column Selection — spk_join","text":"","code":"spk_join(   target_tbl,   mask_tbl,   target_col_return = \"*\",   mask_col_return = NULL,   mask_col_filter = NULL,   mask_col_filter_values = NULL,   mask_col_filter_values_negate = FALSE,   join_fun = sf::st_intersects,   path_gpkg = NULL,   collapse = FALSE,   target_col_collapse = NULL,   ... )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_join.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial Join with Optional Mask Filtering and Column Selection — spk_join","text":"target_tbl sf::sf target table spatially joined. mask_tbl character sf::sf mask table name (reading path_gpkg) sf object. target_col_return character vector target column names retain. Use \"*\" retain . mask_col_return character NULL Optional. vector mask column names retain. Default NULL. mask_col_filter character NULL Optional. single mask column name used filtering rows. mask_col_filter_values character NULL Optional. Values match (exclude) mask_col_filter. mask_col_filter_values_negate logical Whether exclude (TRUE) include (FALSE) matching rows. Default FALSE. join_fun function Spatial predicate function sf::st_intersects(), sf::st_within(), etc. Default sf::st_intersects. path_gpkg character NULL Optional. Path GeoPackage read mask_tbl already sf object. collapse logical Whether collapse results one amalgamated row multiple results one result returned. Default TRUE target_col_collapse character NULL Optional. target column name group facilitate collapsing result. ... Additional arguments passed sf::st_join().","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_join.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial Join with Optional Mask Filtering and Column Selection — spk_join","text":"sf object result spatial join. target_col_return \"*\", selected columns returned.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_layer_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","title":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","text":"Extracts summarises information layers within spatial vector data source. Attempts determine geometry type layer querying sample feature.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_layer_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","text":"","code":"spk_layer_info(path)"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_layer_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","text":"path character single string. Path vector spatial data source (e.g., GeoPackage shapefile).","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_layer_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","text":"data.frame data frame available layers geometry types. layer contains geometry, error occurs reading, geomtype NA.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_layer_info.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise Layers and Geometry Types in a Spatial Data Source — spk_layer_info","text":"Uses sf::st_layers() list available layers data source. layer, attempts read single feature using SQL query determines geometry type using sf::st_geometry_type(). Layers geometry errors reading safely assigned NA. driver column removed output may contain invalid entries data frame operations.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct Docker Command Arguments for ODM — spk_odm","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"Generates arguments running OpenDroneMap Docker container (MUST RUNNING args PASSED ) specified project path. function can produce either vector arguments processx::run complete Docker command string ready copy paste terminal, depending interactive parameter. includes opinionated params_default optimized processing high-resolution imagery, producing outputs digital surface model (DSM) digital terrain model (DTM).","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"","code":"spk_odm(   path_project,   params_default = c(\"--dtm\", \"--dsm\", \"--pc-quality\", \"low\", \"--dem-resolution\", \"10\"),   params_add = NULL,   interactive = FALSE )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"path_project character absolute path directory project held. Must valid directory. params_default character NULL Optional. character vector opinionated parameters include arguments. Defaults c(\"–dtm\", \"–dsm\", \"–cog\", \"–pc-quality\", \"low\", \"–dem-resolution\", \"10\"). params_add character NULL Optional. character vector additional parameters include arguments. interactive logical Whether include -ti flag interactive mode. TRUE, full command including docker returned single string terminal use. Default FALSE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"character vector arguments pass processx::run, single string full command terminal use interactive = TRUE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"default, function generates DTM DSM outputs using --dtm --dsm flags.  --cog generation appears corrupted metadata writing left seperate step. Additional parameters can passed params_add character vector. interactive = TRUE, full command including docker returned single string terminal use. details steps arguments, see OpenDroneMap documentation: https://docs.opendronemap.org/arguments/","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_odm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct Docker Command Arguments for ODM — spk_odm","text":"","code":"if (FALSE) { # \\dontrun{ path_project <- \"/Volumes/backup_2022/backups/new_graph/archive/uav_imagery/fraser/nechacko/2024/199174_necr_trib_dog\" args <- spk_odm(   path_project,   params_add = c(\"--rerun-from\", \"odm_dem\", \"--orthophoto-kmz\", \"--copy-to\", \"~/Projects\"),   interactive = FALSE ) processx::run(command = \"docker\", args = args, echo = TRUE)  # Generate a quick running command for interactive terminal use: interactive_command <- spk_odm(   path_project,   params_default = NULL,   params_add = c(\"--fast-orthophoto\",                \"--pc-quality\", \"low\",                \"--skip-report\",               \"--orthophoto-resolution\", \"20\"),               ,   interactive = TRUE   )  cat(interactive_command, \"\\n\")  #process multiple project files that contain `images` directory paths <- c(\"/Volumes/backup_2022/backups/new_graph/archive/uav_imagery/skeena/bulkley/2024/8530_sandstone_test\",            \"/Volumes/backup_2022/backups/new_graph/archive/uav_imagery/skeena/bulkley/2024/8530_sandstone_test2\")  args2 <- lapply(paths, spk_odm)  args2 |> purrr::walk(   ~ processx::run(     command = \"docker\",     args = .x,     echo = TRUE   ) ) } # }"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_poly_to_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","title":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","text":"function generates regularly spaced grid points inside polygon given sf object assigns ID. point density determined specified column.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_poly_to_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","text":"","code":"spk_poly_to_points(sf_in, col_density, col_id = NULL)"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_poly_to_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","text":"sf_in sf object containing polygon geometries. col_density character name column containing point density values per polygon. col_id character NULL name column use ID. Defaults \"id\" NULL.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_poly_to_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","text":"sf object containing generated points ID column.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_poly_to_points.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Regularly Spaced Points Inside Polygons — spk_poly_to_points","text":"","code":"poly <- sf::st_sf(   region = c(\"A\", \"B\"),   col_density = c(1, 5),   geometry = sf::st_sfc(     sf::st_polygon(list(rbind(c(0, 0), c(10, 0), c(10, 10), c(0, 10), c(0, 0)))),     sf::st_polygon(list(rbind(c(15, 15), c(20, 15), c(20, 20), c(15, 20), c(15, 15))))   ) )  points <- spk_poly_to_points(poly, col_density = \"col_density\", col_id = \"region\")  plot(sf::st_geometry(poly))  plot(sf::st_geometry(points), add = TRUE, col = \"red\", pch = 16)"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Layer Information from QGIS Project — spk_q_layer_info","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"Reads QGIS project file (.qgs .qgz) extracts layer metadata, including menu name, provider, data source, layer name.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"","code":"spk_q_layer_info(path, attrs = c(\"id\", \"name\", \"source\", \"providerKey\"))"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"path character single file path QGIS project file. Must end .qgs .qgz. attrs character Optional. character vector XML attribute names extract layer node. Defaults c(\"id\", \"name\", \"source\", \"providerKey\").","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"tibble::tibble one row per layer, including extracted attributes, plus computed layer_name time_exported, sorted alphabetically name.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"input .qgz file, unzipped extract internal project.qgs. function parses XML structure project extract layer information <layer-tree-layer> nodes. Returned columns include: name_menu: layer name displayed QGIS menu provider: data provider key (e.g., ogr, gdal) source: absolute relative path data source layer_name: internal layer name string id: QGIS-assigned layer id time_exported: timestamp format yyyymmdd hh::mm function run","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_q_layer_info.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Layer Information from QGIS Project — spk_q_layer_info","text":"","code":"if (FALSE) { # \\dontrun{ res <- spk_q_layer_info(   \"~/Projects/gis/ng_koot_west_2023/ng_koot_west_2023.qgs\",   attrs = c(\"id\", \"name\", \"source\", \"providerKey\") ) } # }"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"Computes combined spatial extent (bounding box) one raster files. ensures input rasters share CRS optionally reprojects bounding box specified CRS. function relies terra::ext(), terra::crs(), sf::st_bbox() extent extraction CRS handling.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"","code":"spk_rast_ext(x, crs_out = NULL)"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"x character vector file paths, URLs, database connection strings raster data sources. path must exist accessible GDAL. crs_out character NULL Optional. CRS string (e.g., \"EPSG:4326\") reproject combined bounding box. NULL, CRS input rasters retained. Default NULL.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"bounding box object : xmin: Minimum x-coordinate. xmax: Maximum x-coordinate. ymin: Minimum y-coordinate. ymax: Maximum y-coordinate. crs_out specified, bounding box reprojected target CRS.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"function ensures input rasters share CRS computing union extents. resulting bounding box can reprojected target CRS crs_out provided. uses terra::ext() extract extents, terra::crs() check CRS consistency, sf::st_bbox() constructing reprojecting bounding box.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_ext.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Combined Extent (Bounding Box) from Multiple Raster Files — spk_rast_ext","text":"","code":"if (FALSE) { # \\dontrun{ # Define input files files_in <- c(   \"/path/to/file1.tif\",   \"/path/to/file2.tif\",   \"/path/to/file3.tif\" )  # Get the combined extent without reprojection bbox_combined <- spk_rast_ext(files_in)  # Get the combined extent and reproject to EPSG:4326 bbox_reprojected <- spk_rast_ext(files_in, crs_out = \"EPSG:4326\") } # }"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_not_empty.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if Raster Has Non-Zero Data — spk_rast_not_empty","title":"Check if Raster Has Non-Zero Data — spk_rast_not_empty","text":"Determines whether raster file contains non-zero values.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_not_empty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if Raster Has Non-Zero Data — spk_rast_not_empty","text":"","code":"spk_rast_not_empty(f)"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_not_empty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if Raster Has Non-Zero Data — spk_rast_not_empty","text":"f character single file path raster file.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_not_empty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if Raster Has Non-Zero Data — spk_rast_not_empty","text":"logical TRUE raster non-zero values, otherwise FALSE.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_rm_empty.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove Empty Raster Files — spk_rast_rm_empty","title":"Remove Empty Raster Files — spk_rast_rm_empty","text":"Scans directory raster files (e.g., .tif, .tiff, .vrt) removes contain zero values. Uses spk_rast_not_empty() check raster.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_rm_empty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove Empty Raster Files — spk_rast_rm_empty","text":"","code":"spk_rast_rm_empty(   path = NULL,   delete = TRUE,   regexp = \"\\\\.(tif|tiff|vrt)$\",   quiet = FALSE )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_rm_empty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove Empty Raster Files — spk_rast_rm_empty","text":"path character single path search raster files. delete logical Whether delete empty files. Default TRUE. regexp character regular expression passed fs::dir_ls() select raster files. Default '\\.(tif|tiff|vrt)$'. quiet logical FALSE, prints messages files can removed. Default FALSE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_rast_rm_empty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove Empty Raster Files — spk_rast_rm_empty","text":"character character vector paths raster files empty. Returns invisibly.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Resolution from a Raster — spk_res","title":"Extract Resolution from a Raster — spk_res","text":"function calculates extracts resolution (metres) single pixel (centre) raster file. determines central pixel raster, crops single pixel, returns resolution specified CRS. Uses terra::rast(), terra::ext(), terra::crop(), terra::project() perform operations.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Resolution from a Raster — spk_res","text":"","code":"spk_res(path, crs_out = \"EPSG:3005\")"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Resolution from a Raster — spk_res","text":"path character file path input raster. crs_out character desired CRS (default \"EPSG:3005\").","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Resolution from a Raster — spk_res","text":"numeric vector length two representing resolution single pixel metres specified CRS.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Resolution from a Raster — spk_res","text":"function first calculates extent resolution raster, identifies central pixel, crops raster pixel. projects cropped raster specified CRS calculates resolution single pixel.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_res.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Resolution from a Raster — spk_res","text":"","code":"path <- system.file(\"extdata\", \"test1.tif\", package = \"spacehakr\") crs_out <- \"EPSG:32609\" spk_res(path, crs_out) #> [1] 20 20"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"Retrieve raster assets single STAC item optional clipping AOI optional spectral index calculation. calc = NULL, function simply returns first asset (asset_a), optionally clipped. calc specifies index (e.g., \"ndvi\"), function reads required assets computes index.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"","code":"spk_stac_calc(   feature,   aoi = NULL,   asset_a = \"red\",   asset_b = \"nir08\",   asset_c = NULL,   calc = \"ndvi\",   vsi_prefix = \"/vsicurl/\",   quiet = FALSE,   timing = FALSE )"},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"feature list single STAC Item (one element items$features list). aoi sf::sf NULL Optional. AOI object used restrict reads (bbox) crop mask output. NULL, full assets read crop/mask applied. Default NULL. asset_a character single string giving asset name first () input band. NDVI corresponds red band. Default \"red\". asset_b character NULL Optional. single string giving asset name second input band. NDVI corresponds NIR band. RGB green band. Required calc NULL. Default \"nir08\". asset_c character NULL Optional. single string giving asset name third input band. Required calc = \"rgb\" (blue band). Default NULL. calc character NULL Optional. calculation perform: NULL: calculation; return asset_a (optionally clipped). \"ndvi\": Normalized Difference Vegetation Index using (asset_b - asset_a) / (asset_b + asset_a). \"rgb\": Stack three bands RGB composite. Requires asset_a (red), asset_b (green), asset_c (blue). Default \"ndvi\". vsi_prefix character Optional. single string giving GDAL VSI prefix used terra::rast() enable streaming, windowed reads HTTP. Exposed allow alternative VSI backends (e.g. /vsis3/). Default \"/vsicurl/\". quiet logical Optional. TRUE, suppress CLI messages. Default FALSE. timing logical Optional. TRUE, emit simple elapsed-time messages reads. Default FALSE.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"terra::SpatRaster asset values calculated index values.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"default asset names (\"red\" \"nir08\") align common conventions Landsat Collection 2 Level-2 STAC items (e.g. landsat-c2-l2 collection Planetary Computer), fully parameterized support collections different band naming schemes. function expects feature provide required assets referenced asset_a , calc NULL, also asset_b (asset_c RGB). aoi NULL, feature must also properties$\"proj:epsg\" AOI can transformed windowed reads. calc = NULL, asset_a read returned (optionally clipped AOI). calc = \"ndvi\", function computes Normalized Difference Vegetation Index using (b - ) / (b + ). calc = \"rgb\", three assets stacked RGB composite native resolution. structure allows additional spectral indices (e.g. NDWI, EVI) added future without changing data access cropping logic. aoi provided, reading limited AOI bounding box feature's projected CRS, cropped/masked AOI. aoi = NULL, full assets read returned full raster extent.","code":""},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"production-ready-alternative","dir":"Reference","previous_headings":"","what":"Production-ready alternative","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"function proof concept demonstrating perform raster calculations STAC items using terra. production workflows involving time series reductions, multi-image composites, data cubes varying pixel sizes coordinate reference systems, consider gdalcubes package. Key functions include: stac_image_collection(): Create image collection directly STAC query results automatic band detection VSI prefix handling. cube_view(): Define spatiotemporal extent, resolution, aggregation, resampling method single specification. raster_cube(): Build data cube image collection, automatically reprojecting resampling images common grid. apply_pixel(): Apply arithmetic expressions (e.g., \"(nir - red) / (nir + red)\") across pixels. reduce_time(): Temporal reductions (mean, median, max, etc.) composite multi-date imagery.","code":""},{"path":[]},{"path":"http://www.newgraphenvironment.com/spacehakr/reference/spk_stac_calc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve and optionally calculate spectral indices from a STAC item — spk_stac_calc","text":"","code":"if (FALSE) { # \\dontrun{ # STAC query against Planetary Computer (Landsat C2 L2) stac_url <- \"https://planetarycomputer.microsoft.com/api/stac/v1\" y <- 2000 date_time <- paste0(y, \"-05-01/\", y, \"-07-30\")  # Define an AOI from a bounding box (WGS84) bbox <- c(   xmin = -126.55350240037997,   ymin =  54.4430453753869,   xmax = -126.52422763064457,   ymax =  54.46001902038006 )  aoi <- sf::st_as_sfc(sf::st_bbox(bbox, crs = 4326)) |>   sf::st_as_sf()  stac_query <- rstac::stac(stac_url) |>   rstac::stac_search(     collections = \"landsat-c2-l2\",     datetime = date_time,     intersects = sf::st_geometry(aoi)[[1]],     limit = 200   ) |>   rstac::ext_filter(`eo:cloud_cover` <= 10)  items <- stac_query |>   rstac::post_request() |>   rstac::items_fetch() |>   rstac::items_sign_planetary_computer()  ndvi_list <- items$features |>   purrr::map(spk_stac_calc, aoi = aoi)  ndvi_list <- ndvi_list |>   purrr::set_names(purrr::map_chr(items$features, \"id\"))  # Retrieve a single asset (no calculation) from Sentinel-2 stac_query_s2 <- rstac::stac(stac_url) |>   rstac::stac_search(     collections = \"sentinel-2-l2a\",     datetime = \"2023-07-01/2023-07-31\",     intersects = sf::st_geometry(aoi)[[1]],     limit = 10   ) |>   rstac::ext_filter(`eo:cloud_cover` <= 10)  items_s2 <- stac_query_s2 |>   rstac::post_request() |>   rstac::items_fetch() |>   rstac::items_sign_planetary_computer()  # Get just the visual (RGB) asset clipped to AOI, no calculation visual_list <- items_s2$features |>   purrr::map(spk_stac_calc, aoi = aoi, asset_a = \"visual\", calc = NULL)  # Build RGB composite from native 10m bands (higher resolution than visual) rgb_list <- items_s2$features |>   purrr::map(     spk_stac_calc,     aoi = aoi,     asset_a = \"B04\",     asset_b = \"B03\",     asset_c = \"B02\",     calc = \"rgb\"   ) } # }"}]
